import{a as Le,b as Ve}from"./chunk-3JSKEPPX.js";import{b as ye,c as Te,d as Se}from"./chunk-7G62XUVV.js";import{a as K,b as Q,c as Y}from"./chunk-LQ337VE2.js";import{a as I}from"./chunk-QQTBYX4Q.js";import{a as ke}from"./chunk-5WYIQFZU.js";import"./chunk-J7XLSKBM.js";import"./chunk-NZOIZJP2.js";import"./chunk-3OMDW2B2.js";import{b as ze}from"./chunk-5OYVGCDM.js";import{a as Pe,b as he,c as Oe,d as Ie,e as Ue,f as we,h as De,i as Ne,k as Fe,l as Ae}from"./chunk-D5SWGX2S.js";import{a as be,b as Ee}from"./chunk-CDW3W3IW.js";import"./chunk-5TLHWZXQ.js";import{a as Ge}from"./chunk-6YTSYAD3.js";import{b as ge,c as Ce,d as xe,g as Me,h as ve}from"./chunk-MZE6JQV3.js";import{b as le,d as E,f as ce,g as se,h as de,j as F,l as me,m as pe,n as ue,p as fe,q as _e}from"./chunk-RMJXZBAS.js";import{a as oe,b as ae}from"./chunk-3354VIHL.js";import{a as ee,b as te,d as ne,h as ie,i as re}from"./chunk-BQHFBY6P.js";import{b as Z,f as S}from"./chunk-4JQI7GWC.js";import{s as T}from"./chunk-R5CXRUDK.js";import"./chunk-HU7WFQWJ.js";import{pa as W,ya as J}from"./chunk-W36LFFSO.js";import{$b as w,Cc as l,Dc as m,Ec as _,Fc as H,Gc as $,Hc as B,Ic as j,Lc as P,Nc as X,Ob as M,Pc as q,Tb as d,Yb as v,aa as V,ac as D,bc as r,cc as i,cd as N,dc as f,ec as z,fc as R,hc as O,jb as k,l as G,ma as u,nb as n,pc as b,rc as c,wa as C,xa as x,xb as y}from"./chunk-YUWHBJVV.js";var A=t=>({length:t});function je(t,o){if(t&1&&(r(0,"mat-error"),l(1),i()),t&2){let e=c().$implicit;n(),_(" ",e("user.edit.usernameRequiredError")," ")}}function Xe(t,o){if(t&1&&(r(0,"mat-error"),l(1),i()),t&2){let e=c().$implicit,a=c();n(),_(" ",e("user.edit.usernameShortError",P(1,A,a.USERNAME_MIN_LENGTH))," ")}}function qe(t,o){if(t&1&&(r(0,"mat-error"),l(1),i()),t&2){let e=c().$implicit,a=c();n(),_(" ",e("user.edit.usernameLongError",P(1,A,a.USERNAME_MAX_LENGTH))," ")}}function We(t,o){if(t&1&&(r(0,"mat-error"),l(1),i()),t&2){let e=c().$implicit,a=c();n(),_(" ",e("user.edit.bioLongError",P(1,A,a.BIO_MAX_LENGTH))," ")}}function Je(t,o){if(t&1){let e=O();r(0,"div",1)(1,"h1",2),l(2),i(),r(3,"form",3)(4,"mat-form-field",4)(5,"mat-label"),l(6),i(),f(7,"input",5),M(8,je,2,1,"mat-error")(9,Xe,2,3,"mat-error")(10,qe,2,3,"mat-error"),i(),r(11,"mat-form-field",4)(12,"mat-label"),l(13),i(),f(14,"textarea",6),r(15,"mat-hint",7),l(16),i(),M(17,We,2,3,"mat-error"),i()(),f(18,"mat-divider"),r(19,"app-action-buttons",8),b("cancel",function(){C(e);let s=c();return x(s.cancel())})("confirm",function(){C(e);let s=c();return x(s.save())}),i()()}if(t&2){let e=o.$implicit,a=c();n(2),m(e("user.edit.title")),n(),d("formGroup",a.form),n(3),m(e("user.edit.username")),n(2),v(a.usernameCtrl.hasError("required")?8:-1),n(),v(a.usernameCtrl.hasError("minlength")?9:-1),n(),v(a.usernameCtrl.hasError("maxlength")?10:-1),n(3),m(e("user.edit.bio")),n(3),H(" ",a.bioCtrl.value.length||0," / ",a.BIO_MAX_LENGTH," "),n(),v(a.bioCtrl.hasError("maxlength")?17:-1),n(2),d("confirmText",e("button.save"))}}var U=class t{dialogRef=u(Ie);data=u(Ue);userService=u(I);USERNAME_MIN_LENGTH=3;USERNAME_MAX_LENGTH=50;BIO_MAX_LENGTH=500;form=new de({username:new F("",[E.required,E.minLength(this.USERNAME_MIN_LENGTH),E.maxLength(this.USERNAME_MAX_LENGTH)]),bio:new F("",E.maxLength(this.BIO_MAX_LENGTH))});get usernameCtrl(){return this.form.get("username")}get bioCtrl(){return this.form.get("bio")}save(){if(this.form.invalid)return;let o={username:this.usernameCtrl.value.trim(),profilePictureUrl:this.data.user.profilePictureUrl,bio:this.bioCtrl.value?.trim()??""};this.userService.updateSelf(o).subscribe(e=>{e&&this.dialogRef.close()})}cancel(){this.dialogRef.close()}ngOnInit(){if(!this.data?.user){console.log(this.data.user);return}this.usernameCtrl.setValue(this.data.user.username),this.bioCtrl.setValue(this.data.user.bio)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=y({type:t,selectors:[["app-edit-user-dialog"]],decls:1,vars:0,consts:[["class","dialog-container",4,"transloco"],[1,"dialog-container"],["mat-dialog-title","",1,"title"],["mat-dialog-content","",1,"edit-profile-form",3,"formGroup"],["appearance","fill",1,"form-field"],["matInput","","placeholder","Enter your username","formControlName","username"],["matInput","","placeholder","Tell us about yourself","formControlName","bio","cdkTextareaAutosize","","cdkAutosizeMinRows","8","cdkAutosizeMaxRows","12"],["align","end"],[1,"action-buttons",3,"cancel","confirm","confirmText"]],template:function(e,a){e&1&&M(0,Je,20,11,"div",0)},dependencies:[ve,Me,ge,xe,Ce,S,Fe,De,Ne,_e,me,le,ce,se,pe,ue,Ae,J,Oe,he,Pe,Ee,be,T],styles:[".dialog-container[_ngcontent-%COMP%]{padding:var(--spacing-large)}.dialog-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;color:var(--text-color);font-size:var(--font-size-h2);margin-bottom:var(--spacing-large)}.dialog-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:var(--spacing-medium)}.dialog-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{width:100%}.dialog-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   mat-error[_ngcontent-%COMP%]{font-size:var(--font-size-additional)}.dialog-container[_ngcontent-%COMP%]   mat-divider[_ngcontent-%COMP%]{margin-bottom:var(--spacing-small)}"]})};var Re=(t,o)=>o.id,Ze=t=>({date:t}),Ke=t=>({count:t});function Qe(t,o){if(t&1){let e=O();r(0,"button",17),b("click",function(){C(e);let s=c(2);return x(s.editProfile())}),r(1,"mat-icon"),l(2,"edit"),i(),l(3),i()}if(t&2){let e=c().$implicit;n(3),m(e("user.profile.edit"))}}function Ye(t,o){if(t&1&&f(0,"app-friend-actions",9),t&2){let e,a=c(2);d("userId",(e=(e=a.user())==null?null:e.id)!==null&&e!==void 0?e:0)}}function et(t,o){if(t&1&&f(0,"app-collection-tile",14),t&2){let e=o.$implicit;d("collection",e)("isOnCollectionPage",!1)}}function tt(t,o){if(t&1&&(r(0,"div",16),f(1,"app-friend-tile",18),i()),t&2){let e=o.$implicit;n(),d("friend",e)}}function nt(t,o){if(t&1){let e=O();z(0),r(1,"div",1)(2,"mat-card",2)(3,"div",3),f(4,"img",4),r(5,"div",5)(6,"div")(7,"mat-card-title"),l(8),i(),r(9,"mat-card-subtitle"),l(10),i()(),r(11,"div")(12,"mat-card-subtitle",6)(13,"mat-icon"),l(14,"calendar_month"),i(),l(15),X(16,"date"),i(),r(17,"mat-card-subtitle",7),b("click",function(){C(e);let s=c();return x(s.changeTab(2))}),r(18,"mat-icon"),l(19,"people"),i(),l(20),i()()()(),r(21,"div"),M(22,Qe,4,1,"button",8)(23,Ye,1,1,"app-friend-actions",9),i()()(),r(24,"mat-tab-group",10),j("selectedIndexChange",function(s){C(e);let h=c();return B(h.selectedTab,s)||(h.selectedTab=s),x(s)}),r(25,"mat-tab",11)(26,"div",12)(27,"h4"),l(28),i(),r(29,"div"),l(30),i()()(),r(31,"mat-tab",11)(32,"div")(33,"h4"),l(34),i(),r(35,"div",13),w(36,et,1,2,"app-collection-tile",14,Re),i()()(),r(38,"mat-tab",11)(39,"div")(40,"h4"),l(41),i(),r(42,"div",15),w(43,tt,2,1,"div",16,Re),i()()()(),R()}if(t&2){let e,a,s,h,L,g=o.$implicit,p=c();n(4),d("src",(e=(e=p.user())==null?null:e.profilePictureUrl)!==null&&e!==void 0?e:"user-avatar.png",k),n(4),m((a=p.user())==null?null:a.username),n(2),_("#",(s=p.user())==null?null:s.id,""),n(5),_(" ",g("user.profile.userJoin",P(17,Ze,q(16,14,(h=p.user())==null?null:h.joinDate,"LLLL yyyy")))," "),n(5),_(" ",g("user.profile.friendsCount",P(19,Ke,p.friendsCount()))," "),n(2),v(p.isProfileOwner()?22:23),n(2),$("selectedIndex",p.selectedTab),n(),d("label",g("user.profile.aboutMeLabel")),n(3),m(g("user.profile.aboutMeTitle")),n(2),m((L=p.user())==null?null:L.bio),n(),d("label",g("user.profile.userCollectionsLabel")),n(3),m(g("user.profile.userCollectionsTitle")),n(2),D(p.collections()),n(2),d("label",g("user.profile.userFriendsLabel")),n(3),m(g("user.profile.userFriendsTitle")),n(2),D(p.friends())}}var He=class t{friendService=u(Q);userProfileService=u(Y);userService=u(I);dialog=u(we);user=this.userProfileService.currentProfileUser;collections=this.userProfileService.currentProfileCollections;friends=this.userProfileService.currentProfileFriends;isProfileOwner=N(()=>this.user()?.id===this.userService.selfUser()?.id);friendsCount=N(()=>this.friends().filter(o=>o.status===K.Accepted).length);selectedTab=0;destroy$=new G;changeTab(o){this.selectedTab=o}editProfile(){this.dialog.open(U,{width:"550px",minHeight:"450px",data:{user:this.user()}})}ngOnInit(){this.userProfileService.profileChange$.pipe(V(this.destroy$)).subscribe(()=>{this.changeTab(0)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=y({type:t,selectors:[["app-user-profile"]],decls:1,vars:0,consts:[[4,"transloco"],[1,"profile-header"],[1,"profile-card"],[1,"left-side"],["mat-card-avatar","","appImgFallback","user-avatar.png","alt","Zdj\u0119cie profilowe","draggable","false",3,"src"],[1,"profile-details"],[1,"sub-text"],[1,"sub-text","friends-count",3,"click"],["mat-stroked-button",""],[3,"userId"],["animationDuration","0",1,"user-content",3,"selectedIndexChange","selectedIndex"],[3,"label"],[1,"bio"],[1,"collections-grid"],[3,"collection","isOnCollectionPage"],[1,"friends-grid"],[1,"friend-tile"],["mat-stroked-button","",3,"click"],[3,"friend"]],template:function(e,a){e&1&&M(0,nt,45,21,"ng-container",0)},dependencies:[re,ee,ie,ne,te,S,Z,ze,fe,ke,W,ae,oe,Se,ye,Te,Le,Ve,Ge,T],styles:[".profile-header[_ngcontent-%COMP%]{display:flex;margin-bottom:var(--spacing-large)}.profile-header[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;padding:var(--spacing-large);width:100%}.profile-header[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]{display:flex;flex-direction:row}.profile-header[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   img[mat-card-avatar][_ngcontent-%COMP%]{width:150px;height:150px;border-radius:50%;margin-bottom:0}.profile-header[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .profile-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--spacing-medium);justify-content:center;margin:0px 0px 0px var(--spacing-large)}.profile-header[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .profile-details[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:var(--font-size-h2);color:var(--text-color);font-weight:700}.profile-header[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .profile-details[_ngcontent-%COMP%]   .sub-text[_ngcontent-%COMP%]{font-size:var(--font-size-additional);color:var(--text-color-additional)}.profile-header[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .profile-details[_ngcontent-%COMP%]   .friends-count[_ngcontent-%COMP%]{cursor:pointer}.profile-header[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .profile-details[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-xs)}.profile-header[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .profile-details[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px}.user-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{text-align:center}.user-content[_ngcontent-%COMP%]   .bio[_ngcontent-%COMP%]{margin:auto;width:fit-content;max-width:1000px;white-space:pre-line}.user-content[_ngcontent-%COMP%]   .collections-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:var(--spacing-medium);padding:var(--spacing-small);overflow-x:hidden}.user-content[_ngcontent-%COMP%]   .collections-grid[_ngcontent-%COMP%]   .collection-card[_ngcontent-%COMP%]{cursor:pointer;transition:transform .2s;border:3px solid rgb(90,90,90);border-radius:var(--border-radius-medium)}.user-content[_ngcontent-%COMP%]   .collections-grid[_ngcontent-%COMP%]   .collection-card[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.user-content[_ngcontent-%COMP%]   .collections-grid[_ngcontent-%COMP%]   .collection-card[_ngcontent-%COMP%]   img[mat-card-image][_ngcontent-%COMP%]{height:150px;object-fit:cover;border-top-left-radius:var(--border-radius-medium);border-top-right-radius:var(--border-radius-medium)}.user-content[_ngcontent-%COMP%]   .friends-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(450px,1fr));gap:var(--spacing-medium);padding:var(--spacing-small)}.user-content[_ngcontent-%COMP%]   .friends-grid[_ngcontent-%COMP%]   .friend-tile[_ngcontent-%COMP%]{height:90px;font-size:var(--font-size-h5)}"]})};export{He as UserProfileComponent};
