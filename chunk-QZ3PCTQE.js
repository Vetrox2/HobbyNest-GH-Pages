import{b,c as y}from"./chunk-LQ337VE2.js";import{a as g,c as _}from"./chunk-R54LHX7Q.js";import{a as d}from"./chunk-QQTBYX4Q.js";import{a as U}from"./chunk-DTNNSDSF.js";import{a as m}from"./chunk-5TLHWZXQ.js";import{a as p,r as u}from"./chunk-4JQI7GWC.js";import{$ as S,H as s,Jb as h,L as v,Q as f,ga as t,l as n,ma as e,p as l,r as c}from"./chunk-YUWHBJVV.js";var o=class i{_collectionDetailsStateService=e(_);_collectionService=e(m);_friendService=e(b);_userProfileService=e(y);_userService=e(d);_homeService=e(U);resetState(){this._collectionDetailsStateService.resetState(),this._collectionService.resetState(),this._friendService.resetState(),this._userProfileService.resetState(),this._userService.resetState(),this._homeService.resetState()}fetchSelfCollectionState(){return this._collectionService.fetchSelfCollections()}fetchSelfFriendState(){return this._friendService.fetchSelfFriends()}fetchSelfUserState(){return this._userService.fetchSelf()}static \u0275fac=function(a){return new(a||i)};static \u0275prov=t({token:i,factory:i.\u0275fac,providedIn:"root"})};var j=class i{refreshUrl="auth/refresh";loginUrl="auth/google";logoutUrl="auth/logout";checkUrl="auth/check";_apiService=e(p);_navigationService=e(g);_stateFacadeService=e(o);_notificationService=e(u);_isRefreshing=h(!1);refreshSubject=new n;get isRefreshing(){return this._isRefreshing()}loginWithGoogle(r){return this._apiService.post(this.loginUrl,{idToken:r})}logout(){this._apiService.post(this.logoutUrl).subscribe(()=>{this._stateFacadeService.resetState(),this._navigationService.navigateToLogin()})}isLoggedIn(){return this._apiService.get(this.checkUrl).pipe(s(()=>c(!1)))}refreshToken(){return this._isRefreshing()?this.refreshSubject.pipe(v(1),S(()=>c(null))):(this._isRefreshing.set(!0),this._apiService.post(this.refreshUrl).pipe(s(r=>(this._navigationService.navigateToLogin(),r.message&&this._notificationService.showFailure(r.message),l)),f(()=>{this._isRefreshing.set(!1),this.refreshSubject.next()})))}static \u0275fac=function(a){return new(a||i)};static \u0275prov=t({token:i,factory:i.\u0275fac,providedIn:"root"})};export{j as a};
