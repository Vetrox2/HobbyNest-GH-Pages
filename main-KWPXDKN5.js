import{a as A}from"./chunk-2AK63OUK.js";import{b as S,c as ie}from"./chunk-LPO5UAHP.js";import{a as m,c as re}from"./chunk-NW3I4PYB.js";import{a as h}from"./chunk-JRISVNOQ.js";import"./chunk-QYTQSEDS.js";import{a as b,d as $,e as ee,h as te,i as oe}from"./chunk-6GCO2BRC.js";import"./chunk-HUJZVVKV.js";import{a as d}from"./chunk-QQTTX4SM.js";import{p as ne}from"./chunk-LWZQ6JOT.js";import"./chunk-CK7GFSRL.js";import{s as y}from"./chunk-GB5FS4AS.js";import{d as X,e as q,f as K,g as Q}from"./chunk-EKZ4N6IU.js";import"./chunk-HU7WFQWJ.js";import{e as W}from"./chunk-KBHRRCXS.js";import{$ as T,C as I,Ca as k,E as c,I as M,Ib as G,La as L,Oc as Z,Pa as j,Sb as V,X as C,Xb as Y,Yb as J,Zb as N,ca as E,fa as x,ia as n,jb as H,la as D,m as g,ma as O,nb as z,o as R,p as _,rb as B,s as l,y as v,za as U}from"./chunk-GTZL7DLP.js";var ae=o=>{let e=n(h),t=n(d),r=n(re),i=n(m),a=n(y),s=Number(o.paramMap.get("id"));return isNaN(s)?(i.navigateToHome(),g):(r.resetState(),v([t.getCollection(s),t.getCollectionItems(s)]).pipe(C(([p,u])=>e.getUserById(p.userId).pipe(l(f=>({collection:p,items:u,user:f})))),l(({collection:p,items:u,user:f})=>{r.setCurrentCollectionData(p,u,f)}),c(()=>(a.showFailure("Pobieranie danych o kolekcji zako\u0144czy\u0142o si\u0119 niepowodzeniem"),i.navigateToHome(),g))))};var P=o=>{let e=n(h),t=n(ie),r=n(S),i=n(d),a=n(m),s=n(y),p=Number(o.paramMap.get("id"));if(Number.isFinite(p)&&p>0&&p!==e.selfUser()?.id)return v([e.getUserById(p),r.getOtherUserFriends(p),i.getUserCollections(p)]).pipe(l(([u,f,he])=>{t.setViewedUser(u,f,he)}),c(()=>(s.showFailure(),a.navigateToHome(),g)));t.resetState(),e.selfUser()||(s.showFailure(),a.navigateToHome())};var se=()=>{let o=n(h),e=n(S),t=n(d),r=n(m);return o.selfUser()?R(!0):o.fetchSelf().pipe(l(()=>(e.selfFriends().length||e.fetchSelfFriends(),t.selfCollections().length||t.fetchSelfCollections(),!0)),c(()=>(r.navigateToLogin(),R(!1))))};var pe=(o,e)=>{let t=n(A),r=n(m);return r.isNavigatingToLogin()?(r.isNavigatingToLogin.set(!1),!0):t.isLoggedIn().pipe(l(i=>i?(r.navigateToHome(),!1):!0))};var le=[{path:"login",loadComponent:()=>import("./chunk-7MC77QVG.js").then(o=>o.LoginComponent),canActivate:[pe]},{path:"",loadComponent:()=>import("./chunk-JICL76ED.js").then(o=>o.ShellComponent),canActivate:[se],children:[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",loadComponent:()=>import("./chunk-UJVGJB7J.js").then(o=>o.HomeComponent)},{path:"search",loadComponent:()=>import("./chunk-FGMCWZ5C.js").then(o=>o.SearchComponent)},{path:"profile",loadComponent:()=>import("./chunk-ZXHWQBFR.js").then(o=>o.UserProfileComponent),resolve:{_:P}},{path:"profile/:id",loadComponent:()=>import("./chunk-ZXHWQBFR.js").then(o=>o.UserProfileComponent),resolve:{_:P}},{path:"collections",loadComponent:()=>import("./chunk-R4NFNO4F.js").then(o=>o.CollectionListComponent)},{path:"collections/:id",loadComponent:()=>import("./chunk-JBKLT4AP.js").then(o=>o.CollectionDetailsComponent),resolve:{_:ae}},{path:"settings",loadComponent:()=>import("./chunk-YFPL2QB5.js").then(o=>o.SettingsPageComponent)},{path:"about",loadComponent:()=>import("./chunk-YVSHGGI7.js").then(o=>o.AboutComponent)},{path:"legal",loadComponent:()=>import("./chunk-6MVPCM4G.js").then(o=>o.LegalComponent)}]},{path:"**",redirectTo:"login",pathMatch:"full"}];var fe="@",ge=(()=>{class o{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=n(U,{optional:!0});loadingSchedulerFn=n(ve,{optional:!0});_engine;constructor(t,r,i,a,s){this.doc=t,this.delegate=r,this.zone=i,this.animationType=a,this.moduleImpl=s}ngOnDestroy(){this._engine?.flush()}loadImpl(){let t=()=>this.moduleImpl??import("./chunk-QIQGAHBF.js").then(i=>i),r;return this.loadingSchedulerFn?r=this.loadingSchedulerFn(t):r=t(),r.catch(i=>{throw new T(5300,!1)}).then(({\u0275createEngine:i,\u0275AnimationRendererFactory:a})=>{this._engine=i(this.animationType,this.doc);let s=new a(this.delegate,this._engine,this.zone);return this.delegate=s,s})}createRenderer(t,r){let i=this.delegate.createRenderer(t,r);if(i.\u0275type===0)return i;typeof i.throwOnSyntheticProps=="boolean"&&(i.throwOnSyntheticProps=!1);let a=new w(i);return r?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(s=>{let p=s.createRenderer(t,r);a.use(p),this.scheduler?.notify(11)}).catch(s=>{a.use(i)}),a}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static \u0275fac=function(r){H()};static \u0275prov=E({token:o,factory:o.\u0275fac})}return o})(),w=class{delegate;replay=[];\u0275type=1;constructor(e){this.delegate=e}use(e){if(this.delegate=e,this.replay!==null){for(let t of this.replay)t(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,t){this.delegate.appendChild(e,t)}insertBefore(e,t,r,i){this.delegate.insertBefore(e,t,r,i)}removeChild(e,t,r){this.delegate.removeChild(e,t,r)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,r,i){this.delegate.setAttribute(e,t,r,i)}removeAttribute(e,t,r){this.delegate.removeAttribute(e,t,r)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,r,i){this.delegate.setStyle(e,t,r,i)}removeStyle(e,t,r){this.delegate.removeStyle(e,t,r)}setProperty(e,t,r){this.shouldReplay(t)&&this.replay.push(i=>i.setProperty(e,t,r)),this.delegate.setProperty(e,t,r)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,r){return this.shouldReplay(t)&&this.replay.push(i=>i.listen(e,t,r)),this.delegate.listen(e,t,r)}shouldReplay(e){return this.replay!==null&&e.startsWith(fe)}},ve=new x("");function ce(o="animations"){return j("NgAsyncAnimations"),D([{provide:z,useFactory:(e,t,r)=>new ge(e,t,r,o),deps:[W,K,k]},{provide:L,useValue:o==="noop"?"NoopAnimations":"BrowserAnimations"}])}var me=(o,e)=>{let t=n(A),r=o.clone({withCredentials:!0});return e(r).pipe(c(i=>i.status===401&&!o.url.includes(t.refreshUrl)?t.refreshToken().pipe(C(()=>{let a=o.clone({withCredentials:!0});return e(a)}),c(a=>_(()=>a))):_(()=>i)))};var de={providers:[Z({eventCoalescing:!0}),te(le),ce(),X(q([me])),O(ne)]};function Ce(o,e){o&1&&(Y(0,"div",0),N(1,"img",1)(2,"div",2),J())}function ye(o,e){o&1&&N(0,"router-outlet")}var F=class o{router=n(ee);isAppReady=!1;ngOnInit(){this.router.events.pipe(I(e=>e instanceof b)).subscribe(()=>document.getElementsByTagName("mat-sidenav-content")[0].scrollTo(0,0)),this.router.events.pipe(I(e=>e instanceof b),M(1)).subscribe(()=>{this.isAppReady=!0})}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=B({type:o,selectors:[["app-root"]],decls:2,vars:1,consts:[[1,"splash"],["src","favicon.svg","alt","MyApp Logo"],[1,"loading-spinner"]],template:function(t,r){t&1&&G(0,Ce,3,0,"div",0)(1,ye,1,0,"router-outlet"),t&2&&V(r.isAppReady?1:0)},dependencies:[oe,$],styles:[".splash[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;text-align:center;gap:50px;width:100%;height:100%;background-color:#212121}.splash[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:120px}.loading-spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid #ccc;border-top-color:#333;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}"]})};Q(F,de).catch(o=>console.error(o));
