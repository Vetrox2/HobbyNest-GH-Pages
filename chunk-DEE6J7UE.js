import{a as j}from"./chunk-X4C7U5TP.js";import{a as U}from"./chunk-P45YCO6N.js";import{b as _,c as y}from"./chunk-FIQT4NFQ.js";import{b}from"./chunk-UET5UCVB.js";import{a as m}from"./chunk-65KQNILW.js";import{a as u}from"./chunk-EQNPCEY6.js";import{a as h,l as g}from"./chunk-EP6N3N6R.js";import{a as I}from"./chunk-23J5AW3P.js";import{a as d}from"./chunk-PCYLCH52.js";import{B as s,Eb as p,F as v,L as S,W as f,ba as r,f as n,ha as e,j as l,l as c}from"./chunk-S4ZUGAIY.js";var k=I("SocialLogin",{web:()=>import("./chunk-3O57NQGP.js").then(i=>new i.SocialLoginWeb)});var o=class i{_collectionDetailsStateService=e(b);_collectionService=e(u);_friendService=e(_);_userProfileService=e(y);_userService=e(m);_homeService=e(U);_statisticsService=e(j);resetState(){this._collectionDetailsStateService.resetState(),this._collectionService.resetState(),this._friendService.resetState(),this._userProfileService.resetState(),this._userService.resetState(),this._homeService.resetState(),this._statisticsService.resetState()}fetchSelfCollectionState(){return this._collectionService.fetchSelfCollections()}fetchSelfFriendState(){return this._friendService.fetchSelfFriends()}fetchSelfUserState(){return this._userService.fetchSelf()}static \u0275fac=function(a){return new(a||i)};static \u0275prov=r({token:i,factory:i.\u0275fac,providedIn:"root"})};var F=class i{refreshUrl="auth/refresh";loginUrl="auth/google";logoutUrl="auth/logout";checkUrl="auth/check";googleClientId="378133115800-ssavoq3n7kl6k78c44g7rlp1qcn5362s.apps.googleusercontent.com";_apiService=e(h);_navigationService=e(d);_stateFacadeService=e(o);_notificationService=e(g);_isRefreshing=p(!1);refreshSubject=new n;get isRefreshing(){return this._isRefreshing()}initGoogleLogin(){k.initialize({google:{webClientId:this.googleClientId}})}loginWithGoogle(t){return this._apiService.post(this.loginUrl,{idToken:t})}logout(){this._apiService.post(this.logoutUrl).subscribe(()=>{this._stateFacadeService.resetState(),this._navigationService.navigateToLoginWithoutGuard()})}isLoggedIn(){return this._apiService.get(this.checkUrl).pipe(s(()=>c(!1)))}refreshToken(){return this._isRefreshing()?this.refreshSubject.pipe(v(1),f(()=>c(null))):(this._isRefreshing.set(!0),this._apiService.post(this.refreshUrl).pipe(s(t=>(this._navigationService.navigateToLoginWithoutGuard(),t.message&&this._notificationService.showFailure(t.message),l)),S(()=>{this._isRefreshing.set(!1),this.refreshSubject.next()})))}static \u0275fac=function(a){return new(a||i)};static \u0275prov=r({token:i,factory:i.\u0275fac,providedIn:"root"})};export{k as a,F as b};
