import{a as _}from"./chunk-XZNZLEHW.js";import{b,c as g}from"./chunk-A3C52VDI.js";import{a as m,b as d}from"./chunk-PZ5TP4O3.js";import{a as u}from"./chunk-FKKXVRBC.js";import{a as S,s as h}from"./chunk-TQO57KJH.js";import{Ab as p,E as l,I as n,N as f,X as v,ca as t,ia as e,j as s,o as c}from"./chunk-7IX7LMTZ.js";var i=class r{_collectionDetailsStateService=e(d);_collectionService=e(h);_friendService=e(b);_userProfileService=e(g);_userService=e(u);_homeService=e(_);resetState(){this._collectionDetailsStateService.resetState(),this._collectionService.resetState(),this._friendService.resetState(),this._userProfileService.resetState(),this._userService.resetState(),this._homeService.resetState()}fetchSelfCollectionState(){return this._collectionService.fetchSelfCollections()}fetchSelfFriendState(){return this._friendService.fetchSelfFriends()}fetchSelfUserState(){return this._userService.fetchSelf()}static \u0275fac=function(a){return new(a||r)};static \u0275prov=t({token:r,factory:r.\u0275fac,providedIn:"root"})};var y=class r{refreshUrl="auth/refresh";loginUrl="auth/google";logoutUrl="auth/logout";checkUrl="auth/check";_apiService=e(S);_navigationService=e(m);_stateFacadeService=e(i);_isRefreshing=p(!1);refreshSubject=new s;get isRefreshing(){return this._isRefreshing()}loginWithGoogle(o){return this._apiService.post(this.loginUrl,{idToken:o})}logout(){this._apiService.post(this.logoutUrl).subscribe(()=>{this._stateFacadeService.resetState(),this._navigationService.navigateToLogin()})}isLoggedIn(){return this._apiService.get(this.checkUrl).pipe(l(()=>c(!1)))}refreshToken(){return this._isRefreshing()?this.refreshSubject.pipe(n(1),v(()=>c(null))):(this._isRefreshing.set(!0),this._apiService.post(this.refreshUrl).pipe(f(()=>{this._isRefreshing.set(!1),this.refreshSubject.next()})))}static \u0275fac=function(a){return new(a||r)};static \u0275prov=t({token:r,factory:r.\u0275fac,providedIn:"root"})};export{y as a};
